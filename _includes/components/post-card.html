{% comment %}
  Post Card Component - Reusable blog post card
  Used in: homepage carousel, blog archive page, related posts
  
  Usage: {% include components/post-card.html post=post %}
  
  Required post attributes:
  - title (string)
  - url (string)
  - excerpt (string)
  - featured_image (string URL)
  - publish_date (ISO 8601 date)
  - category (string, optional)
{% endcomment %}

{% if include.post %}
  {% assign post = include.post %}
  
  <article class="post-card" itemscope itemtype="https://schema.org/BlogPosting">
    
    <a href="{{ post.url | relative_url }}" class="post-card__link" aria-label="Read: {{ post.title }}">
      
      <!-- Featured Image -->
      {% if post.featured_image %}
      <div class="post-card__image">
        <img 
          src="{{ post.featured_image }}?w=800&fm=webp&q=80" 
          alt="{{ post.title | escape }}"
          loading="lazy"
          itemprop="image"
          class="post-card__img"
        />
        
        <!-- Category Badge (overlaid on image) -->
        {% if post.category %}
        <span class="post-card__badge badge badge--{{ post.category | slugify }}">
          {{ post.category }}
        </span>
        {% endif %}
      </div>
      {% else %}
        <!-- Placeholder if no featured image -->
        <div class="post-card__image post-card__image--placeholder">
          <div class="post-card__placeholder-content">
            {% if post.category %}
            <span class="post-card__badge badge badge--{{ post.category | slugify }}">
              {{ post.category }}
            </span>
            {% endif %}
          </div>
        </div>
      {% endif %}

      <div class="post-card__content">
        
        <!-- Post Title -->
        <h3 class="post-card__title" itemprop="headline">
          {{ post.title | escape }}
        </h3>

        <!-- Publish Date -->
        {% if post.publish_date or post.date %}
        <time 
          class="post-card__date" 
          datetime="{{ post.publish_date | default: post.date | date_to_xmlschema }}"
          itemprop="datePublished"
        >
          {{ post.publish_date | default: post.date | date: "%b %-d, %Y" }}
        </time>
        {% endif %}

        <!-- Excerpt (truncated to 150 chars) -->
        {% if post.excerpt %}
          {% assign excerpt_text = post.excerpt | strip_html | truncate: 150, "..." %}
          <p class="post-card__excerpt" itemprop="description">
            {{ excerpt_text }}
          </p>
        {% endif %}

        <!-- Read More CTA -->
        <span class="post-card__cta">
          Read More 
          <svg class="post-card__arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
          </svg>
        </span>

      </div>

      <!-- Hidden metadata for screen readers -->
      <meta itemprop="author" content="{{ site.title }}">
      {% if post.lang %}
      <meta itemprop="inLanguage" content="{{ post.lang }}">
      {% endif %}

    </a>

  </article>

{% else %}
  <!-- Error state if post not provided -->
  <div class="post-card post-card--error">
    <p>Post data not available</p>
  </div>
{% endif %}
